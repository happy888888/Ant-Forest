/*!
 * BUILD_ASSET_META_START {"type":"kylin-build","uniquename":"app/60000002","name":"60000002_ant-forest","hash":"d684ab843087ad1a19fc","chunk":"listFeed","time":1597914305298,"filename":"js/listFeed.d684ab8430.js","site":false,"fengdie":false} BUILD_ASSET_META_END
 */
webpackJsonp([7],{0:function(t,e,a){a(12),t.exports=a(267)},204:function(t,e,a){var n;n={},n["feed-item"]=function(){var t=a(85);return t=t.default||t}(),n["v-avatar"]=function(){var t=a(16);return t=t.default||t}(),n["barrage-panel"]=function(){var t=a(84);return t=t.default||t}(),a(556);var i=a(6)(a(342),a(243),null,null,n);e.__esModule=!0,e.default=i.exports},243:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"af-body"},[a("div",{staticClass:"af-feed feed-list",attrs:{"data-aspm":"c14331"}},[t._l(t.dayInfos,function(e){return[a("div",{key:e.day},[a("div",{staticClass:"line-date"},[t._v(t._s(e.dayStr))]),t._v(" "),a("div",{staticClass:"container"},[a("div",{staticClass:"box statistics"},[a("div",{staticClass:"left bubble af-digital-fontface t2-ignore",attrs:{role:"img"}},[t._v("\n              "+t._s(e.iconValue)+"g\n            ")]),t._v(" "),e.defaultText?a("div",{staticClass:"mid"},[a("div",{staticClass:"line-1 af-ellipsis"},[t._v("\n                "+t._s(e.defaultText)+"\n              ")])]):a("div",{staticClass:"mid"},[a("div",{staticClass:"line-1 af-ellipsis"},[t._v("\n                "+t._s(e.title)+"\n              ")]),t._v(" "),a("div",{staticClass:"line-2 af-ellipsis"},[a("div",{staticClass:"green text-mid"},[t._v(t._s(e.leftText))]),t._v(" "),a("div",{staticClass:"icon-vs t2-ignore",attrs:{role:"img"}}),t._v(" "),a("div",{staticClass:"blue text-mid"},[t._v(t._s(e.rightText))])])])]),t._v(" "),a("p",{staticClass:"af-border-bottom",staticStyle:{"padding-top":"1px"}}),t._v(" "),a("div",{staticClass:"wrap-1"},[a("div",{staticClass:"wrap-2"},[e.robbedDynamics.length||e.hasDayRobList?a("div",{staticClass:"box feed-item single-line"},[a("div",{staticClass:"left avatar-multi"},[a("v-avatar",{staticClass:"pic ROB",attrs:{url:e.firstRobber.headPortrait}})],1),t._v(" "),a("div",{staticClass:"mid-frame"},[a("div",{staticClass:"box mid-box"},[a("div",{staticClass:"mid-left"},[a("div",{staticClass:"line-1 af-ellipsis"},[a("span",{staticClass:"bold"},[t._v(t._s(e.firstRobber.displayName+(e.robInfoLeft||"")))]),t._v(" "),a("span",[t._v(t._s(e.robInfoRight))])])]),t._v(" "),a("div",{class:"mid-right",attrs:{"data-aspm-d":"d98554"}},[e.collapse?a("span",{staticClass:"arrow-text collapse",on:{click:function(a){t.onClickCollapse(e)}}},[t._v("展开 "),a("b",{staticClass:"arrow"})]):a("span",{staticClass:"arrow-text",on:{click:function(a){t.onClickCollapse(e)}}},[t._v("收起 "),a("b",{staticClass:"arrow"})])])]),t._v(" "),e.collapse?t._e():[a("p",{staticClass:"af-border-bottom",staticStyle:{"padding-top":"1px"}}),t._v(" "),a("div",{staticClass:"robbed-list",attrs:{"data-aspm-d":"d98552"}},[t._l(e.robbedDynamics,function(n){return[a("feed-item",{key:n.bizNo,attrs:{item:n,"style-class":{wrap:"mid-box"},"click-feed-params":[e,"robbedDynamics"]},on:{onClickFeed:t.onClickFeed,onClickBtn:t.onClickBtn}})]}),t._v(" "),e.loading?a("p",{staticClass:"list-more"},[t._v("加载中...")]):e.hasMore?a("p",{staticClass:"list-more",on:{click:function(a){t.onClickRobbedMore(e)}}},[t._v("点击加载更多")]):t._e()],2)]],2)]):t._e(),t._v(" "),t._l(e.dynamics,function(n){return[a("div",{key:n.bizNo,class:"box feed-item "+n.type,on:{click:function(e){t.onClickFeed(n)}}},[a("v-avatar",{class:"left pic "+n.type,attrs:{url:n.fromUser.headPortrait}}),t._v(" "),a("div",{staticClass:"mid-frame"},[a("div",{staticClass:"box mid-box",attrs:{"data-aspm-d":"d98552"}},[a("div",{staticClass:"mid-left",on:{touchstart:function(a){a.stopPropagation(),t.onTouchstart(n,e,a)},touchend:function(e){e.stopPropagation(),t.onTouchend(e)}}},[a("div",{staticClass:"line-1 af-ellipsis-2"},["ENERGY_GIVE"===n.type||"COLLECT_PROP"===n.type?a("span",[t._v("收取")]):t._e(),t._v(" "),"OPEN_PACKET"===n.type?a("span",[t._v("领取了")]):t._e(),t._v(" "),a("span",{staticClass:"bold user-name af-ellipsis"},[t._v(t._s(n.fromUser.displayName))]),t._v(" "),a("span",[t._v(t._s(n.content))]),t._v(" "),n.properties&&n.properties.image?a("img",{staticClass:"cont-img",attrs:{src:n.properties.image}}):t._e()]),t._v(" "),a("div",{staticClass:"line-2 af-ellipsis"},[t._v("\n                          "+t._s(n.bizDtStr)+"\n                        ")])]),t._v(" "),n.btn?a("div",{class:"mid-right btn-small"+(n.alreadyOperate?" has-done":""),attrs:{"data-aspm-d":"d98551"},on:{click:function(a){a.stopPropagation(),t.onClickBtn(n,e,"dynamics")}}},[n.btn.icon===!1?a("span",[t._v("  ")]):a("span",{class:"icon af-digital-fontface "+n.type},[t._v(t._s(n.btn.energy||""))]),t._v(" "),a("span",[t._v(t._s(n.btn.text))])]):t._e(),t._v(" "),n.operatedInfo?a("div",{staticClass:"text-flow"},[a("div",{staticClass:"flow-icon af-digital-fontface",style:{backgroundImage:"url("+n.operatedInfo.image+")"}},[t._v("\n                          "+t._s(n.operatedInfo.imageText||"")+"\n                        ")]),t._v("\n                        "+t._s(n.operatedInfo.content)+"\n                      ")]):t._e()])])],1)]})],2)])])])]}),t._v(" "),t.loading?a("p",{staticClass:"list-more"},[t._v("加载中...")]):t.hasMore?a("p",{staticClass:"list-more",on:{click:t.onClickMore}},[t._v("点击加载更多")]):a("p",{staticClass:"list-more"},[t._v("没有更多了")])],2),t._v(" "),a("barrage-panel")],1)},staticRenderFns:[]}},267:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(l.default?(0,l.default)(t,e):t.__proto__=e)}function o(t){window.AlipayJSBridge&&window.AlipayJSBridge.call?t():navigator.userAgent.indexOf("AlipayClient")>=0?document.addEventListener("AlipayJSBridgeReady",t,!0):t()}function d(){var t=function(t){function e(){return i(this,e),r(this,t.apply(this,arguments))}return s(e,t),e.prototype.initOptions=function(){return{store:m.default,router:void 0}},e.prototype.render=function(t){return t(b.default)},e}(p.Page),e=new t("#app");return e._vue}var c=a(9),l=n(c),u=a(13),f=(n(u),a(297)),p=(n(f),a(4)),y=a(287),m=n(y),v=a(204),b=n(v);m.default&&o(function(){m.default.dispatch("pageBeforeRender")}),function(t){window.AlipayJSBridge&&window.AlipayJSBridge.call?setTimeout(t,0):navigator.userAgent.indexOf("AlipayClient")>=0?document.addEventListener("AlipayJSBridgeReady",t,!0):setTimeout(t,0)}(d)},277:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(){return r?r:r="undefined"!=typeof window&&window.Promise&&"function"==typeof window.Promise.resolve?window.Promise:a(1).default||a(1)}Object.defineProperty(e,"__esModule",{value:!0});var r,s=a(8),o=n(s),d=o.default||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},c=a(2),l=n(c),u=a(5),f=n(u),p=a(3),y=n(p),m=a(24),v=n(m),b=a(96),h=n(b),_=a(95),g=n(_),C=a(89);e.default={modules:{barrage:g.default,water:h.default},state:{dayInfos:[],loading:!1,hasMore:!0,lastTimeStamp:void 0,bizNo:Date.now()+"_"+(Math.random()+.1+"").split(".")[1]},mutations:{updateLoading:function(t,e){t.loading=e},updateHasMore:function(t,e){t.hasMore=e},updateLastTimeStamp:function(t,e){t.lastTimeStamp=e},appendDynamics:function(t,e){var a=e.dayStr,n=e.dynamics,i=e.path;if(a&&n&&i){var r=(0,C.getIndex)(t.dayInfos,"dayStr",a,!0);if(r){var s;(s=r.data[i]).push.apply(s,n)}}},appendDayInfos:function(t){var e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(e=t.dayInfos).push.apply(e,a)},updateOneDay:function(t,e){var a=e.dayStr,n=e.data;try{var i=(0,C.getIndex)(t.dayInfos,"dayStr",a);if(i){var r=d({},i.data,n);t.dayInfos.splice(i.index,1,r)}}catch(t){}},updateOneDynamic:function(t,e){var a=e.dayStr,n=e.path,i=e.bizNo,r=e.data;try{var s=(0,C.getIndex)(t.dayInfos,"dayStr",a);if(s){var o=s.data[n],c=(0,C.getIndex)(o,"bizNo",i);if(c)if(r){var l=d({},c.data,r);o.splice(c.index,1,l)}else o.splice(c.index,1)}}catch(t){}}},actions:{pageBeforeRender:function(t){window.AF_STORE=t,y.default.time.listFeedDivideInit()},queryData:function(t){return new(i())(function(e,a){var n,r,s,o,d,c,u,f;return n=t.commit,r=t.state,r.loading||!r.hasMore?e():(n("updateLoading",!0),i().resolve(l.default.rpc.queryDynamicsDayPage(r.lastTimeStamp)).then(function(t){function p(){return d<o.length?(c=o[d],c.dayStr=y.default.time.listFeedDivide(c.date),i().resolve(l.default.relation.queryLocalSocialInfo({result:{robbed:c.robbedDynamics||[],normal:c.dynamics||[],firstRobber:[{userId:c.firstRobberUserId}]},pathList:["robbed","normal","firstRobber"],propPath:["fromUser","fromUser",""],defaultName:"你的好友",defalltPortrait:v.default.DefaultAvatarOnline})).then(function(t){try{return u=t,c.collapse=!(c.robbedDynamics&&c.robbedDynamics.length),c.robbedDynamics=(0,C.supplemenDynamics)(u.robbed),c.dynamics=(0,C.supplemenDynamics)(u.normal),c.firstRobber=u.firstRobber[0]||{},f=c.firstRobber.displayName,f&&f.length>4&&(f=f.substr(0,4)+"...",c.firstRobber.displayName=f),c.dayStr?(n("appendDayInfos",[c]),c.hasDayRobList&&Tracert.expo("c14331.d98554")):n("appendDynamics",{dayStr:r.dayInfos[r.dayInfos.length-1].dayStr,dynamics:c.dynamics,path:"dynamics"}),m}catch(t){return a(t)}}.bind(this),a)):[1]}function m(){return d++,p}function b(){return n("updateHasMore",s.hasMore),n("updateLastTimeStamp",s.lastTimestamp),h.call(this)}function h(){return n("updateLoading",!1),e()}try{if(s=t,s.success){o=s.dayInfo||[],d=0;var _;return(_=function(t){for(;t;){if(t.then)return void t.then(_,a);try{if(t.pop){if(t.length)return t.pop()?b.call(this):t;t=m}else t=t.call(this)}catch(t){return a(t)}}}.bind(this))(p)}return n("updateHasMore",!1),h.call(this)}catch(t){return a(t)}}.bind(this),a))}.bind(this))},queryRobbedData:function(t,e){return new(i())(function(a,n){function r(){return s("updateOneDay",{dayStr:c,data:{loading:!1}}),a()}var s,o,d,c,u,f,p;return s=t.commit,o=t.state,d=e.date,c=e.dayStr,u=(0,C.getIndex)(o.dayInfos,"dayStr",c),u.data.loading?a():(s("updateOneDay",{dayStr:c,data:{loading:!0}}),d?(f=d-(d+288e5)%864e5,i().resolve(l.default.rpc.queryDynamicsRobPage(f)).then(function(t){try{return p=t,p.success&&(s("appendDynamics",{dayStr:c,dynamics:(0,C.supplemenDynamics)(p.robDynamics),path:"robbedDynamics"}),s("updateOneDay",{dayStr:c,data:{hasMore:p.hasMore}})),r.call(this)}catch(t){return n(t)}}.bind(this),n)):r.call(this))}.bind(this))},toggleRobbedDynamics:function(t,e){var a=t.commit,n=t.dispatch,i=t.state,r=e.dayStr,s=(0,C.getIndex)(i.dayInfos,"dayStr",r),o=s.data,d=!o.collapse,c={collapse:d};d||!o.hasDayRobList||o.robbedDynamics&&o.robbedDynamics.length||n("queryRobbedData",e),a("updateOneDay",{dayStr:r,data:c})},handleDynamic:function(t,e){var a=t.commit,n=e||{},i=n.biz,r=n.data;i&&(a("updateOneDynamic",{dayStr:i.dayStr,path:i.path,bizNo:i.id,data:{alreadyOperate:!0,operatedInfo:r}}),(0,C.saveOperate)(i.id+"_"+i.type))},operateDynamic:function(t,e){return new(i())(function(a,n){var r,s,o,d,c;return r=t.commit,s=e.dynamic,o=e.dayStr,d={receiverUserId:s.fromUser.userId,bizType:s.type,bizNo:s.bizNo,bizDt:s.bizDt,action:"PRAISE"},i().resolve(l.default.rpc.operateDynamic(d)).then(function(t){try{return c=t,c.success&&(r("updateOneDynamic",{dayStr:o,path:"dynamics",bizNo:s.bizNo,data:{alreadyOperate:!0}}),y.default.native.toast("已赠送TA "+c.praiseEnergy+"g"),f.default.call("postNotification",{name:"AFListFeedPraised",data:{bizNo:s.bizNo,result:c}})),a()}catch(t){return n(t)}}.bind(this),n)}.bind(this))},deleteDynamic:function(t,e){return new(i())(function(a,n){var r,s,o,d,c;return r=t.commit,s=e.dayStr,o=e.bizDt,d=e.bizNo,i().resolve(l.default.rpc.deleteUserDynamic(d,void 0,o)).then(function(t){try{return c=t,c.success?r("updateOneDynamic",{dayStr:s,path:"dynamics",bizNo:d,data:void 0}):y.default.native.toast(c.error.resultDesc),a()}catch(t){return n(t)}}.bind(this),n)}.bind(this))}}}},287:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(277),r=n(i),s=a(4);r.default.strict=!1,r.default.plugins=[];var o=new s.Store(r.default);s.Store.setInstance?s.Store.setInstance(o):s.Store.getInstance=function(){try{console.warn(["Store.getInstance is deprecated, please use :",'import { Instance } from "@ali/kylin-framework";',"Instance.getStore();"].join("\n"))}catch(t){}return o},s.Instance&&s.Instance.setStore&&s.Instance.setStore(o),e.default=o},297:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}a(18);var i=a(2),r=n(i),s=a(19),o=n(s),d=function(){r.default.drm.init(),(0,o.default)(window.FastClick)};luna.ready(function(){d()})},342:function(t,e,a){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(4),r=a(5),s=n(r),o=a(3),d=n(o),c=a(2),l=n(c),u=i.Component.Object({mapStateToProps:{dayInfos:function(t){return t.dayInfos},loading:function(t){return t.loading},hasMore:function(t){return t.hasMore}}})(function(){var t={name:"IndexView",props:{dayInfos:Array,loading:Boolean,hasMore:Boolean},data:function(){return{}},mounted:function(){var t=this;this._loadMore(!0),window.onscroll=function(){d.default.html.isReachBottom()&&t._loadMore()},Tracert.expo("c14331.d98551"),Tracert.expo("c14331.d98552")},methods:{onClickMore:function(){this._loadMore()},_loadMore:function(t){!this.loading&&this.hasMore&&this.$store.dispatch("queryData")},onClickCollapse:function(t){this.$store.dispatch("toggleRobbedDynamics",t),Tracert.click("c14331.d98554")},onClickRobbedMore:function(t){this.$store.dispatch("queryRobbedData",t)},onClickFeed:function(t,e){var a=t.fromUser?t.fromUser.userId:t.userId;l.default.goto.homePage({userId:a}),Tracert.click("c14331.d98552")},onClickBtn:function(t,e,a){if(!t.alreadyOperate){var n="dynamic_"+t.bizNo;if(!d.default.lock.isLocked(n)){d.default.lock.lock(n);var i=t.btn,r=t.fromUser.userId,s={id:t.bizNo,dayStr:e.dayStr,type:t.type,path:a,action:"handleDynamic"};switch(i.actionType){case"WATER":this.$store.dispatch("water/sendEnergy",{targetUserId:r,energyId:i.actionValue,energy:parseInt(i.energy,10),singleton:!0,biz:s,from:"dynamics"});break;case"BARRAGE":var o={userId:r,biz:s};if(i.actionValue){this.$store.commit("barrage/updateTargetUser",o);var c=Math.floor(i.actionValue.length*Math.random()),l=i.actionValue[c];this.$store.dispatch("barrage/sendBarrage",{id:l})}else this.$store.dispatch("barrage/showPanel",o);break;case"PRAISE":this.$store.dispatch("operateDynamic",{dynamic:t,dayStr:e.dayStr})}setTimeout(function(){d.default.lock.unlock(n)},2e3),Tracert.click("c14331.d98551",{feedType:t.type})}}},onTouchstart:function(t,e,a){var n=this;clearInterval(this.Loop),"BARRAGE"===t.type&&(this.Loop=setTimeout(function(){s.default.call("actionSheet",{btns:["删除弹幕"],cancelBtn:"取消",destructiveBtnIndex:0},function(a){0===a.index&&n.$store.dispatch("deleteDynamic",{bizNo:t.bizNo,bizDt:t.bizDt,dayStr:e.dayStr})})},1e3))},onTouchend:function(){clearInterval(this.Loop)}}};return t});e.default=u},556:function(t,e){}});